import{_ as a,c as i,a3 as n,o as p}from"./chunks/framework.C681U02K.js";const o=JSON.parse('{"title":"frp","description":"","frontmatter":{},"headers":[],"relativePath":"gadgets/frp/frp.md","filePath":"gadgets/frp/frp.md","lastUpdated":1739546373000}'),t={name:"gadgets/frp/frp.md"};function e(l,s,h,k,r,d){return p(),i("div",null,s[0]||(s[0]=[n(`<h1 id="frp" tabindex="-1">frp <a class="header-anchor" href="#frp" aria-label="Permalink to &quot;frp&quot;">​</a></h1><h2 id="xia-zai-frp" tabindex="-1">下载 frp <a class="header-anchor" href="#xia-zai-frp" aria-label="Permalink to &quot;下载 frp&quot;">​</a></h2><p>下载 <a href="https://github.com/fatedier/frp/releases" target="_blank" rel="noreferrer">frp</a> 后，目录下</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">frp_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;version&gt;_linux_amd64</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> frpc</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # frp client 客户端</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> frpc.toml</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # frp client 配置文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> frps</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # frp server 服务端</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> frps.toml</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # frp server 配置文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LICENSE</span></span></code></pre></div><h3 id="fu-wu-duan" tabindex="-1">服务端 <a class="header-anchor" href="#fu-wu-duan" aria-label="Permalink to &quot;服务端&quot;">​</a></h3><p>部署 frps 并编辑 <code>frps.toml</code> 文件。以下是简化的配置，其中设置了 frp 服务器用于接收客户端连接的端口：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>bindPort = 7000</span></span></code></pre></div><p>需要开放对应的端口</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PORT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">7000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --permanent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --zone=public</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --add-port=\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PORT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}/tcp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 添加 frps 端口  </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --reload</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # 更新防火墙规则</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --list-ports</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 查看已开放的端口</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># sudo firewall-cmd --permanent --zone=public --remove-port=$PORT/tcp # 移除端口</span></span></code></pre></div><blockquote><p><code>firewalld</code> 可能需要安装</p></blockquote><p>重启 ssh 服务使配置生效：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sshd</span></span></code></pre></div><h3 id="ke-hu-duan" tabindex="-1">客户端 <a class="header-anchor" href="#ke-hu-duan" aria-label="Permalink to &quot;客户端&quot;">​</a></h3><p>修改 <code>frpc.toml</code> 配置文件，配置 frpc 服务端</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   frpc.toml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gedit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> frpc.toml</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 如果是图形界面</span></span></code></pre></div><div class="language-toml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">toml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">serverAddr = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;x.x.x.x&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">serverPort = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">proxies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ssh&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">type = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tcp&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">localIP = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;127.0.0.1&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">localPort = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">22</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">remotePort = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6000</span></span></code></pre></div><h2 id="shi-yong-systemd-lai-guan-li-frp-fu-wu" tabindex="-1">使用 systemd 来管理 frp 服务 <a class="header-anchor" href="#shi-yong-systemd-lai-guan-li-frp-fu-wu" aria-label="Permalink to &quot;使用 systemd 来管理 frp 服务&quot;">​</a></h2><h3 id="shi-yong-systemd-lai-guan-li-frps-fu-wu" tabindex="-1">使用 systemd 来管理 frps 服务 <a class="header-anchor" href="#shi-yong-systemd-lai-guan-li-frps-fu-wu" aria-label="Permalink to &quot;使用 systemd 来管理 frps 服务&quot;">​</a></h3><p>在 Linux 系统下，使用 systemd 可以方便地控制 frps 服务端的启动、停止、配置后台运行以及开机自启动。</p><p>在 <code>/etc/systemd/system</code> 下创建 <code>frps.service</code> 用于配置 frps 服务</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/systemd/system/frps.service</span></span></code></pre></div><p>写入内容</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[Unit]</span></span>
<span class="line"><span># 服务名称，可自定义</span></span>
<span class="line"><span>Description = frp server</span></span>
<span class="line"><span>After = network.target syslog.target</span></span>
<span class="line"><span>Wants = network.target</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[Service]</span></span>
<span class="line"><span>Type = simple</span></span>
<span class="line"><span># 启动 frps 的命令, 需修改为您的 frps 的安装路径</span></span>
<span class="line"><span>ExecStart = /path/to/frps -c /path/to/frps.toml</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[Install]</span></span>
<span class="line"><span>WantedBy = multi-user.target</span></span></code></pre></div><p>使用 systemd 命令管理 frps 服务</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   frps</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 启动 frp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    frps</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 停止 frp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> frps</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 重启 frp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  frps</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 查看 frp 状态</span></span></code></pre></div><p>设置 frps 开机自启动</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> frps</span></span></code></pre></div><p>通过遵循上述步骤，您可以轻松地使用 systemd 来管理 frps 服务，实现启动、停止、自动运行和开机自启动。确保替换路径和配置文件名称以匹配您的实际安装。</p><h3 id="shi-yong-systemd-lai-guan-li-frpc-fu-wu" tabindex="-1">使用 systemd 来管理 frpc 服务 <a class="header-anchor" href="#shi-yong-systemd-lai-guan-li-frpc-fu-wu" aria-label="Permalink to &quot;使用 systemd 来管理 frpc 服务&quot;">​</a></h3><p>在 Linux 系统下，使用 systemd 可以方便地控制 frpc 服务端的启动、停止、配置后台运行以及开机自启动。</p><p>将 frpc 移动到 <code>/usr/local/bin</code> 目录下，配置文件移动到 <code>/etc/frp</code> 目录下</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> frpc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/bin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/frp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> frpc.toml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/frp</span></span></code></pre></div><p>在 <code>/etc/systemd/system</code> 下创建 <code>frpc.service</code> 用于配置 frpc 服务</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/systemd/system/frpc.service</span></span></code></pre></div><p>写入内容</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[Unit]</span></span>
<span class="line"><span># 服务名称，可自定义</span></span>
<span class="line"><span>Description = frpc server</span></span>
<span class="line"><span>After=network.target network-online.target</span></span>
<span class="line"><span>Wants=network-online.target</span></span>
<span class="line"><span># 确保只有在网络可用的情况下，服务才会运行</span></span>
<span class="line"><span>Requires=network-online.target</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[Service]</span></span>
<span class="line"><span>Type = simple</span></span>
<span class="line"><span># 启动 frpc 的命令, 修改为您的 frpc的安装路径</span></span>
<span class="line"><span>ExecStart = /path/to/frpc -c /path/to/frpc.toml</span></span>
<span class="line"><span>ExecStart = /etc/frp/frpc -c /etc/frp/frpc.toml</span></span>
<span class="line"><span>ExecStop=/bin/kill $MAINPID</span></span>
<span class="line"><span># 设置服务在退出时总是重启。无论是正常退出还是异常崩溃，服务都会尝试重启。</span></span>
<span class="line"><span>Restart=always</span></span>
<span class="line"><span>RestartSec=10</span></span>
<span class="line"><span># 禁用启动限制，意味着服务可以无限次重启，而不会被 systemd 限制</span></span>
<span class="line"><span>StartLimitInterval=0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[Install]</span></span>
<span class="line"><span>WantedBy = multi-user.target</span></span></code></pre></div><p>使用 systemd 命令管理 frpc 服务</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   frpc</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 启动 frp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    frpc</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 停止 frp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> frpc</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 重启 frp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  frpc</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 查看 frp 状态</span></span></code></pre></div><p>设置 frpc 开机自启动</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> frpc</span></span></code></pre></div>`,40)]))}const F=a(t,[["render",e]]);export{o as __pageData,F as default};
